<% @title = "Listing Agents" %>

<% content_for :description do %>
  <% end %>

      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <div class="card card-sheet sheet-condensed">
              <table class="table table-striped table-hover table-sm-responsive">
                <thead>
                  <tr>
                                          <th>Agent ID</th>
                                          <th>Full Name</th>
                                          <th>Email</th>
                                          <th>Department Name</th>
                                          <th>Occurrences Since Dap</th>
                                        <th></th>
                  </tr>
                </thead>
                <tbody>
                <% @agents.each do |agent| %>
                  <tr>
                                          <td><%= agent.user.id %></td>
                                          <td><%= agent.user.full_name %></td>
                                          <td><%= agent.user.email %></td>
                                          <td><%= agent.department.name.truncate(20) %></td>
                                          <td><%= agent.user.daps.map{|m| m.foo.to_f}.first %></td>
                                        <td class="actions text-right">
                      <div class="btn-group">
                        <%= link_to theme_icon_tag("eye"), agent, 'data-toggle': 'tooltip', title: 'Show', class: "btn btn-link" %>
                        <%= link_to theme_icon_tag("pencil-alt"), edit_agent_path(agent), 'data-toggle': 'tooltip', title: 'Edit', class: "btn btn-link" %>
                        <%= link_to theme_icon_tag("trash"), agent, 'data-toggle': 'tooltip', title: 'Delete',
                        data: { confirm: 'Are you sure?' }, method: :delete, class: 'btn btn-link' %>
                      </div>
                      </td>
                    </tr>
                    <% end %>
                    <% if @agents.length == 0 %>
                    <tr><td colspan=42 class='text-center'>No agents.</td></tr>
                    <% end %>
                </tbody>
              </table>
            </div>  
          </div>
        </div>
      </div>
