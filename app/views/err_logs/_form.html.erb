<script>
  jQuery(function() {
  var users;
  users = $('#err_log_user_id').html();
  console.log(users);
  return $('#err_log_department_id').change(function() {
    var department, options;
    department = $('#err_log_department_id :selected').text();
    options = $(users).filter("optgroup[label=" + department + "]").html();
    console.log(options);
    if (options) {
      return $('#err_log_user_id').html(options);
    } else {
      return $('#err_log_user_id').empty();
    }
  });
});

$(function() {
    $('.datepicker').datepicker({format: 'yyyy-mm-dd'});
});

</script>


<%= form_for(@err_log, html: { class: 'form-horizontal' }) do |f| %>
  <%= f.error_notification %>

    <%= f.form_group :department_id, class: 'row' do |f| %>
      <%= f.label 'Department', class: 'control-label col-md-3' %>
      <div class='col-12 col-md-9'>
        <%= f.collection_select :department_id, Department.order(:id), :id, :name, class: 'form-control form-control-sm' %>
        <%= f.error_messages %>
      </div>
    <% end %>

    <%= f.form_group :user_id, class: 'row' do |f| %>
      <%= f.label 'Agent', class: 'control-label col-md-3' %>
      <div class='col-12 col-md-9'>
        <%= f.grouped_collection_select :user_id, Department.order(:id), :users, :name, :id, :full_name, class: 'form-control' %>
        <%= f.error_messages %>
      </div>
    <% end %>


  <div class="form-inputs">
    <%= f.form_group :serviceorder, class: 'row' do |f| %>
      <%= f.label 'Service Order', class: 'control-label col-md-3' %>
      <div class='col-12 col-md-9'>
        <%= f.text_field :serviceorder, class: 'form-control form-control-sm'%>
        <%= f.error_messages %>
      </div>
    <% end %>

    <%= f.form_group :errdate, class: 'row' do |f| %>
      <%= f.label 'Error Date', class: 'control-label col-md-3' %>
      <div class='col-12 col-md-9'>
        <%= f.text_field :errdate, class: 'datepicker', 'data-provide': 'datepicker', 'placeholder': 
        'YYYY-MM-DD' %>
        <%= f.error_messages %>
      </div>
    <% end %>

    <%= f.form_group :errdesc, class: 'row' do |f| %>
      <%= f.label 'Description', class: 'control-label col-md-3' %>
      <div class='col-12 col-md-9'>
        <%= f.text_area :errdesc, class: 'form-control form-control-sm' %>
        <%= f.error_messages %>
      </div>
    <% end %>

    <%= f.form_group :err_cost, class: 'row' do |f| %>
      <%= f.label 'Error Cost', class: 'control-label col-md-3' %>
      <div class='col-12 col-md-9'>
        <%= f.number_field :err_cost, class: 'form-control form-control-sm', 'value': '0.00' %>
        <%= f.error_messages %>
      </div>
    <% end %>

    <%= f.form_group :err_name_id, class: 'row' do |f| %>
      <%= f.label 'Error Type', class: 'control-label col-md-3' %>
      <div class='col-12 col-md-9'>
        <%= f.collection_select :err_name_id, ErrName.order(:id), :id, :errname, class: 'form-control form-control-sm' %>
        <%= f.error_messages %>
      </div>
    <% end %>

<%= f.hidden_field :err_status_id, value: '1' %>


<%= f.hidden_field :errsubmitby, value: current_user.full_name %>

  </div>

  <div class="d-flex">
    <div class="ml-auto">
      <%= f.submit class: 'btn btn-primary' %>
      <%= link_to "Cancel", err_logs_path, class: 'btn btn-outline-default', 'data-dismiss': 'modal' %>
    </div>
  </div>
<% end %>

