<%= stylesheet_link_tag "pagination.css" %>
<%= stylesheet_link_tag("https://cdn.datatables.net/select/1.3.0/css/select.bootstrap4.min.css") %>
<% @title = "All Entries" %>

<% content_for :description do %>
  <% end %>
  <% content_for :actions do %>
    <%= link_to new_entry_path, class: 'btn btn-primary btn-large pull-right' do %>
      <%= fa_icon_tag "plus" %> Add Entry
    <% end %>
  <% end %>

<style>
body::-webkit-scrollbar {
    width: 5px;
    height: 5px;
}

.table-responsive::-webkit-scrollbar {
  width: 5px;
    height: 5px;
}

</style>

  <script>

$(document).ready(function(t){
var t = $('#entryTable').DataTable({ 
        "pageLength": 10,
        select: true,
        dom: 'Bfrtip',
        buttons: [
          'copy', 'csvHtml5'
          ], 
        columns: [ 
              { data: 'Agent'}, 
              { data: 'Department' }, 
              { data: 'Occurrence' },
              { data: 'Value' },
              { data: 'Date' },
              { data: 'Expiration' },
              { data: 'Description' },
              { data: '' } 
            ]
          });
  t.draw();



t.rows.add(
  [<% @entries.each do |entry| -%><% if entry.user.deleted_at.nil? %>{'Agent': '<%= entry.user.full_name %>', 'Department': '<%= entry.department.name.truncate(15) %>', 'Occurrence': '<%= entry.occurrence.name.truncate(12) %>', 'Value': '<%= entry.occurrence.ovalue %>', 'Date': '<%= entry.edate %>', 'Expiration': '<%= entry.edate + 180.days %>', 'Description': '<%= entry.edesc.gsub(/\R+/, " ").truncate(10) %>', '':'<%= link_to theme_icon_tag("eye"), entry, "data-toggle": "tooltip", title: "Show", class: "btn btn-link p-1"%> <%= link_to theme_icon_tag("pencil-alt"), edit_entry_path(entry), "data-toggle": "tooltip", title: "Edit", class: "btn btn-link p-1" %> <%= link_to theme_icon_tag("trash"), entry, "data-toggle": "tooltip", title: "Delete", data: { confirm: "Are you sure?" }, method: :delete, class: "btn btn-link p-1" %>'},<% else %><% end %><% end -%>]
  ).draw();
t.buttons().container()
    .appendTo( $('.col-sm-6:eq(0)', t.table().container() ) );
});
  </script>

<div id="modal-calendar">
</div>
<div id="modal-agent_list">
</div>
    <!-- <i class="fa fa-calendar"></i> Calendar -->
      <div class="container">
        <div class="row">
          <div class="col-md-10">
            <div class="card card-sheet sheet-condensed">
              <div class="table-responsive">
                <table class="table table-striped table-hover table-sm-responsive" id="entryTable">
                  <thead>
                    <tr>
                                            <th>AGENT</th>
                                            <th>DEPARTMENT</th>
                                            <th>OCCURRENCE</th>
                                            <th>VALUE</th>
                                            <th>DATE</th>
                                            <th>EXP</th>
                                            <th>DESC</th>
                                            <th><!-- Action Button Column --></th>
                    </tr>
                  </thead>
                  <tbody>
                  </tbody>

                </table>
              </div>
            </div>
          </div>    
          <div class="col-md-2">
            <ul class="nav nav-stacked nav-caret-left card small pb-2  ">
              <li>
                <h6 class="mt-3 ml-3">Additional Actions</h6>
              </li>
              <li class="nav-item">
                <%= link_to entries_agent_list_path, :class => "nav-link font-weight-bold", :remote => true, "data-toggle" => "modal", "data-target" => "#modal-agent" do %>
                <%= fa_icon_tag "list" %> All Agents
                <% end %>
              </li>
              <li class="nav-item active">
                <%= link_to entries_calendar_path, :class => "nav-link font-weight-bold", :remote => true, "data-toggle" => "modal", "data-target" => "#modal-window" do %>
                <%= fa_icon_tag "calendar" %> Calendar
                <% end %>
              </li>
              <li class="nav-item">
                <a href="/myresults.csv" class="nav-link font-weight-bold"><i class="fa fa-file-excel-o "></i> Export All</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      
<%= javascript_include_tag("https://cdn.datatables.net/select/1.3.0/js/dataTables.select.min.js") %>
